<template>
  <header class="text-gray-600 body-font nav-bg">
    <div
      class="
        container
        mx-auto
        flex flex-wrap
        p-3
        flex-col
        md:flex-row
        items-center
        gap-y-3
      "
    >
      <nav
        class="flex md:w-4/12 lg:w-4/12 flex-wrap items-center text-base m-auto"
      >
        <router-link to="/" class="hover:text-gray-900">
          <svg
            width="183"
            height="27"
            viewBox="0 0 183 47"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M113.862 46.211V0.640625H125.253V46.211H113.862Z"
              fill="#2D0860"
            />
            <path
              d="M56.9316 0.640625V17.729L85.4114 46.211H102.5L68.3231 12.0321H91.1083V16.8292H102.5V12.0321V10.4116V0.640625H56.9316Z"
              fill="#2D0860"
            />
            <path
              d="M45.5888 0.640625H0V12.0321H45.5888V0.640625Z"
              fill="#2D0860"
            />
            <path
              d="M45.5888 29.1208V17.7293H11.3915V12.0325L0 19.5449V36.5162L11.3915 46.2114H45.5888V34.8177H11.3915V29.1208H45.5888Z"
              fill="#2D0860"
            />
            <path
              d="M136.622 0.640625V46.211H170.798L182.19 34.8196V0.642923H136.622V0.640625ZM148.016 12.0321H170.801V31.7278L167.711 34.8173H148.016V12.0321Z"
              fill="#2D0860"
            />
          </svg>
        </router-link>
      </nav>

      <div
        class="
          flex
          order-first
          lg:order-none
          md:w-5/12
          lg:w-6/12
          title-font
          font-medium
          items-center
          text-gray-900
          lg:items-center lg:justify-center
          md:justify-center
          xl:justify-end
          md:mb-0
        "
      >
        <router-link
          to="/referral"
          class="text-uppercase mr-4 border-button button-menu"
          ><h4>Your referral</h4>
        </router-link>

        <a
          href="#"
          @click="connectWallet"
          class="text-uppercase mr-4 border-button button-menu"
        >
          <h4 v-if="!walletAccount">Connect wallet</h4>
          <h4 v-if="walletAccount">{{ shortAddress }}</h4>
        </a>
      </div>

      <!-- Social media -->
      <div class="md:w-3/12 lg:w-2/12 inline-flex lg:justify-end lg:ml-0">
        <a href="https://t.me/eciospace">
          <svg
            class="mt-1"
            width="50"
            height="30"
            viewBox="0 0 49 49"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M22.9653 0H26.0334C26.1613 0.0268423 26.2776 0.0575186 26.4016 0.0792481C27.9204 0.334889 29.4698 0.489553 30.9553 0.879406C40.0192 3.25431 47.1118 11.0667 48.6267 20.2711C48.7737 21.1658 48.8824 22.0605 49 22.963V26.0307C48.9284 26.6135 48.8722 27.1989 48.7839 27.7792C47.9555 33.5414 45.4793 38.4817 41.18 42.407C34.9784 48.0682 27.666 50.0941 19.4471 48.444C13.0691 47.1658 8.01176 43.7057 4.32356 38.3564C0.577829 32.9253 -0.703133 26.8922 0.3605 20.3887C1.18379 15.3653 3.42867 11.0322 6.98008 7.39697C10.6568 3.64033 15.0928 1.28715 20.2755 0.380905C21.1666 0.219851 22.0691 0.122708 22.9653 0ZM24.1644 32.2555C24.3268 32.3693 24.4572 32.4587 24.585 32.5533C26.3952 33.8861 28.205 35.2192 30.0144 36.5528C31.2928 37.4936 32.2043 37.151 32.5329 35.6044C33.8598 29.3591 35.1834 23.1129 36.5036 16.8659C36.5774 16.5074 36.5947 16.1395 36.5547 15.7756C36.4703 15.0202 35.8542 14.6137 35.1088 14.7837C34.9085 14.834 34.7119 14.8985 34.5208 14.9767C28.831 17.1684 23.1421 19.3614 17.4541 21.5557C15.2705 22.398 13.087 23.2391 10.9125 24.1031C10.4727 24.2782 9.9626 24.5236 9.99073 25.0822C10.0189 25.6408 10.5711 25.7865 11.0262 25.931C12.8467 26.5074 14.6735 27.0634 16.4914 27.6514C16.6448 27.7087 16.81 27.7269 16.9722 27.7046C17.1344 27.6823 17.2886 27.6201 17.4208 27.5236C21.0967 25.1973 24.7768 22.8777 28.4611 20.565C29.31 20.0308 30.1563 19.4888 31.0115 18.9635C31.2902 18.7935 31.5907 18.6132 32.0253 18.9277C31.6776 19.26 31.3593 19.577 31.0269 19.8774C27.5956 22.9783 24.1657 26.0801 20.737 29.1827C20.5623 29.3332 20.4441 29.5388 20.4021 29.7656C20.2832 31.0987 20.2001 32.4357 20.108 33.7715C20.0658 34.4016 20.0313 35.0331 19.993 35.6632L20.1208 35.791C20.4596 35.5852 20.8431 35.428 21.1295 35.1647C22.1484 34.2227 23.1353 33.2474 24.1644 32.2555Z"
              fill="#2D0860"
            />
          </svg>
        </a>

        <a href="https://www.facebook.com/eciospace">
          <svg
            class="mt-1"
            width="50"
            height="30"
            viewBox="0 0 50 49"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M24.6193 0C11.0233 0 0 11.0233 0 24.6193C0 36.9618 9.09275 47.1543 20.9388 48.9351V31.1435H14.8475V24.6727H20.9388V20.3664C20.9388 13.237 24.4121 10.1083 30.3372 10.1083C33.1746 10.1083 34.6763 10.3196 35.3862 10.414V16.0621H31.3445C28.8293 16.0621 27.9512 18.4481 27.9512 21.1357V24.6727H35.3226L34.3235 31.1435H27.9512V48.9863C39.9675 47.3574 49.2387 37.0829 49.2387 24.6193C49.2387 11.0233 38.2154 0 24.6193 0Z"
              fill="#2D0860"
            />
          </svg>
        </a>

        <a href="https://twitter.com/ECIOspace">
          <svg
            class="mt-1"
            width="51"
            height="30"
            viewBox="0 0 51 50"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M24.0151 0C25.0413 0 26.0666 0 27.0928 0C27.2161 0.0269805 27.3385 0.0693783 27.4628 0.0790142C31.1967 0.361345 34.6675 1.46658 37.9168 3.32727C46.4542 8.21651 51.354 18.1684 49.9558 27.9055C48.999 34.5745 45.8654 40.0265 40.53 44.1343C35.1445 48.2815 29.0094 49.8686 22.2777 49.0158C17.6911 48.4347 13.5852 46.6444 10.0151 43.6997C5.3263 39.8318 2.4047 34.9031 1.31681 28.9115C1.15204 27.9999 1.0605 27.0768 0.934265 26.1585C0.934265 25.1323 0.934265 24.107 0.934265 23.0808C1.00461 22.495 1.06531 21.9081 1.14818 21.3232C1.84004 16.4215 3.78552 12.0824 7.07039 8.37551C10.8987 4.05478 15.6608 1.36444 21.3604 0.370981C22.2402 0.217771 23.1305 0.122376 24.0151 0ZM15.1424 27.1982C16.0925 29.6255 17.8154 30.8897 20.3987 31.1576C17.9108 33.0058 15.2349 33.7429 12.1861 33.4876C12.3509 33.6109 12.4405 33.6947 12.5436 33.7526C17.5831 36.5826 22.8154 36.9102 27.9562 34.324C33.8408 31.3638 36.5928 26.2751 36.7942 19.7584C36.8067 19.3556 36.8944 19.0945 37.2307 18.842C38.1268 18.1684 38.8765 17.3465 39.5154 16.3935C38.5229 16.6624 37.5699 16.9206 36.6169 17.1788C36.5976 17.1355 36.5793 17.0921 36.56 17.0497C37.6036 16.3126 38.387 15.3827 38.8225 14.079C38.6067 14.1859 38.4728 14.2669 38.3292 14.3208C37.4485 14.6533 36.5629 14.9732 35.6841 15.3104C35.3893 15.4232 35.1966 15.3394 34.9634 15.1312C33.2732 13.6222 31.3152 13.2079 29.2011 13.9826C27.0677 14.7651 25.8334 16.3646 25.5443 18.631C25.4653 19.2525 25.5327 19.8923 25.5327 20.5562C20.8709 20.2267 17.0358 18.2436 13.9485 14.6369C12.6014 17.6288 13.1689 20.0976 15.6887 22.2396C15.1559 22.1375 14.7569 22.0893 14.3754 21.9814C13.9812 21.8706 13.6035 21.7019 13.2123 21.5564C13.0302 23.9037 14.5873 25.9109 17.4877 27.1992C16.7371 27.1982 15.9836 27.1982 15.1424 27.1982Z"
              fill="#2D0860"
            />
          </svg>
        </a>

        <a href="https://medium.com/@EcioOfficial">
          <svg
            class="mt-1"
            width="51"
            height="30"
            viewBox="0 0 51 50"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M25.5069 0C11.9105 0 0.887573 11.022 0.887573 24.6193C0.887573 38.2158 11.9105 49.2387 25.5069 49.2387C39.1033 49.2387 50.1263 38.2158 50.1263 24.6193C50.1263 11.022 39.1033 0 25.5069 0ZM39.3976 14.1138C38.6379 14.836 37.8704 15.5506 37.1251 16.2882C37.0059 16.4055 36.9309 16.6248 36.9309 16.796C36.9213 22.0228 36.9203 27.2496 36.9338 32.4764C36.9347 32.6687 37.0424 32.9034 37.178 33.0438C37.8002 33.6872 38.4417 34.3123 39.0947 34.9249C39.3024 35.1201 39.3928 35.3182 39.3168 35.6125C35.7153 35.6125 32.1051 35.6125 28.4786 35.6125C28.4276 35.374 28.4324 35.1797 28.6411 34.9854C29.3229 34.3517 29.9807 33.691 30.6549 33.0486C30.8453 32.8668 30.927 32.662 30.927 32.3994C30.9232 28.294 30.9241 24.1875 30.9241 20.0821C30.9241 20.0321 30.9193 19.9811 30.8693 19.9176C30.8347 19.9936 30.7972 20.0677 30.7664 20.1446C28.7738 25.1916 26.7802 30.2376 24.7953 35.2874C24.701 35.5259 24.5808 35.5865 24.3308 35.6067C23.9451 35.6384 23.7682 35.4999 23.6143 35.1489C23.0402 33.8333 22.4266 32.535 21.8265 31.23C20.1272 27.5285 18.4269 23.8279 16.7276 20.1263C16.6901 20.0455 16.6507 19.9657 16.5555 19.8897C16.5555 19.9811 16.5555 20.0725 16.5555 20.1638C16.5555 23.4922 16.5709 26.8197 16.542 30.1481C16.5362 30.83 16.7276 31.3589 17.17 31.8657C18.0317 32.8534 18.8414 33.8853 19.6877 34.8864C19.8666 35.098 19.9041 35.3057 19.8474 35.5721C17.1094 35.5721 14.3753 35.5721 11.6403 35.5721C11.5749 35.3057 11.6326 35.1008 11.8076 34.8931C12.7327 33.7929 13.6416 32.6783 14.559 31.5724C14.7927 31.2906 14.9273 30.9771 14.9264 30.6069C14.9206 29.0152 14.9148 27.4236 14.9139 25.832C14.9119 23.2547 14.9129 20.6774 14.9148 18.1C14.9148 17.7779 14.8071 17.5076 14.5984 17.2605C13.7541 16.2574 12.9126 15.2515 12.0884 14.2321C11.9807 14.0994 11.9817 13.8782 11.9163 13.6435C12.0875 13.6435 12.175 13.6435 12.2625 13.6435C14.7581 13.6435 17.2546 13.6464 19.7502 13.6378C19.9589 13.6368 20.0464 13.7157 20.1272 13.8926C22.1121 18.2472 24.1028 22.5998 26.0926 26.9524C26.1339 27.0419 26.1772 27.1303 26.2388 27.2582C26.2945 27.1274 26.3378 27.0322 26.3763 26.9351C28.1131 22.6123 29.8528 18.2904 31.581 13.9638C31.681 13.7128 31.8012 13.6349 32.0695 13.6358C34.4026 13.6484 36.7357 13.6435 39.0687 13.6416C39.1764 13.6416 39.2841 13.6291 39.3918 13.6224C39.3976 13.7878 39.3976 13.9503 39.3976 14.1138Z"
              fill="#2D0860"
            /></svg
        ></a>
      </div>
      <!-- Social media -->
    </div>
  </header>
</template>

<script>
import mautic from "mautic-tracking";

mautic.initialize("https://mt.ecio.space/mtc.js");
export default {
  computed: {
    //ตัด address ให้เป็นรูปแบบสั้น
    shortAddress() {
      return "".concat(
        this.walletAccount.substring(0, 6),
        "...",
        this.walletAccount.slice(-4)
      );
    },
  },
  data() {
    return {
      walletAccount: "",
    };
  },
  name: "Navbar",
  mounted() {
    var that = this;
    window.ethereum.on("accountsChanged", function () {
      that.connectWallet();
      that.walletAccount = window.ethereum.selectedAddress;
      that.$emit("connected", window.ethereum.selectedAddress);
    });

    window.ethereum.on("chainChanged", () => {
      that.connectWallet();
      that.walletAccount = window.ethereum.selectedAddress;
      that.$emit("connected", window.ethereum.selectedAddress);
    });

    window.ethereum.on("disconnect", () => {
      that.walletAccount = "";
      that.$emit("disconnected", window.ethereum.selectedAddress);
    });

    window.ethereum.on("connected", () => {
      that.$emit("connected", window.ethereum.selectedAddress);
    });

    if (window.ethereum.selectedAddress != "") {
      that.connectWallet();
    }
  },
  methods: {
    async connectWallet() {
      if (this.validated()) {
        this.switchNetwork();
        await window.ethereum.request({
          method: "eth_requestAccounts",
        });

        console.log(window.ethereum.selectedAddress);
        this.walletAccount = window.ethereum.selectedAddress;

        mautic.pageView({
          walletaddress: window.ethereum.selectedAddress,
          firstname: window.ethereum.selectedAddress,
        });
      }
    },
    validated() {
      if (typeof window.ethereum !== "undefined") {
        console.log("MetaMask is installed!");
        return true;
      }

      return false;
    },
    async switchNetwork() {
      await window.ethereum.request({
        method: "wallet_addEthereumChain",
        params: [
          {
            chainId: "0x38",
            chainName: "BSCMAINET",
            rpcUrls: ["https://bsc-dataseed1.binance.org"],
            nativeCurrency: {
              name: "BINANCE COIN",
              symbol: "BNB",
              decimals: 18,
            },
            blockExplorerUrls: ["https://bscscan.com/"],
          },
          // {
          //     chainId: "80001",
          //     chainName: "Poligon Testnet",
          //     rpcUrls: ["https://rpc-mumbai.maticvigil.com"],
          //     nativeCurrency: {
          //       name: "MATIC",
          //       symbol: "MATIC",
          //       decimals: 18,
          //     },
          //     blockExplorerUrls: ["https://mumbai-explorer.matic.today/"],
          //   },
        ],
      });
    },
  },
};
</script>
<style scoped>
.border-button {
  border: 2px solid #2d0860;
  padding: 5px 15px;
}

@media screen and (max-width: 560px) {
  .button-menu {
    font-size: 0.7rem;
  }
}
</style>
